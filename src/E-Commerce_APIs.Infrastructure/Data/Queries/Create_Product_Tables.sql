CREATE TABLE Brand (
    id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL UNIQUE,
    deleted_at TIMESTAMP,
    is_deleted BOOLEAN DEFAULT FALSE,
    creation_Date TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    modified_Date TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    slug VARCHAR(255) UNIQUE
);

CREATE TABLE Product (
    id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    small_image VARCHAR(500),
    brand_Id INT,
    reviews_count INT DEFAULT 0,
    creation_date TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    modified_date TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    slug VARCHAR(255) UNIQUE,
    feature JSONB,
    deleted_at TIMESTAMP,
    is_deleted BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (brand_Id) REFERENCES Brand(id) ON DELETE SET NULL,
    CHECK (Reviews_Count >= 0)
);


CREATE TABLE Category (
    id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    display_text VARCHAR(255) NOT NULL,
    description TEXT,
	creation_date TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    modified_date TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP,
    is_deleted BOOLEAN DEFAULT FALSE,
    slug VARCHAR(255) UNIQUE
);

CREATE TABLE Product_Category (
    id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    product_id INT NOT NULL,
    category_id INT NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (product_id) REFERENCES Product(id) ON DELETE CASCADE,
    FOREIGN KEY (category_id) REFERENCES Category(id) ON DELETE CASCADE,
    UNIQUE (product_id, category_id)
);

CREATE TABLE Product_Images (
    id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    image VARCHAR(500) NOT NULL,
    alt VARCHAR(255),
    description TEXT,
    product_id INT NOT NULL,
    creation_date TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    modified_date TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    slug VARCHAR(255),
    FOREIGN KEY (product_id) REFERENCES Product(id) ON DELETE CASCADE
);